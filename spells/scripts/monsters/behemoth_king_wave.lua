	BEHE_WAVE_FRAMES = {}

	BEHE_WAVE_FRAMES[1] = {
		{1, 1, 1},
		{1, 3, 1},
		{1, 1, 1},
	}

	BEHE_WAVE_FRAMES[2] = {
		{1, 1, 1, 1, 1},
		{1, 0, 0, 0, 1},
		{1, 0, 3, 0, 1},
		{1, 0, 0, 0, 1},
		{1, 1, 1, 1, 1},
	}

	BEHE_WAVE_FRAMES[3] = {
		{1, 1, 1, 1, 1, 1, 1},
		{1, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 3, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 1},
		{1, 1, 1, 1, 1, 1, 1},
	}

	BEHE_WAVE_FRAMES[4] = {
		{1, 1, 1, 1, 1, 1, 1, 1, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 3, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 1, 1, 1, 1, 1, 1, 1, 1},
	}

	BEHE_WAVE_FRAMES[5] = {
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 3, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
	}

	BEHE_WAVE_FRAMES[6] = {
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
	}

	BEHE_WAVE_FRAMES[7] = {
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
	}

	BEHE_WAVE_FRAMES[8] = {
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 1},
		{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
	}
	local PLAYERS_HITS = 0

	local PHASE = {}
	PHASE[1] = { begin = 100, interval = 1000, min = 275, max = 390 }
	PHASE[2] = { begin = 60, interval = 600, min = 335, max = 460 }
	PHASE[3] = { begin = 20, interval = 300, min = 415, max = 525 }

	local CURRENT_PHASE = 1

	local combats_frames = {}
	local combat_areas = {}

	for k,v in pairs(BEHE_WAVE_FRAMES) do
		combats_frames[k] = createCombatObject()
		setCombatParam(combats_frames[k], COMBAT_PARAM_TYPE, COMBAT_DEATHDAMAGE)
		setCombatParam(combats_frames[k], COMBAT_PARAM_EFFECT, CONST_ME_MORTAREA)

		function onTargetCreature(cid, target) 
			
			if(isPlayer(target)) then
				PLAYERS_HITS = PLAYERS_HITS + 1

			  local players = tonumber(getStorage(gid.EVENT_BKING_PLAYERS))

		  	  local lifePercent = math.floor((getCreatureHealth(cid) * 100) / getCreatureMaxHealth(cid))
          local damage
			  if players <= 3 and getStorage(gid.EVENT_BKING) == EVENT_STATE_WAITING and lifePercent > 10 then
			  	damage = math.random(3500, 4500)
		      else
		      	damage = math.random(PHASE[CURRENT_PHASE].min, PHASE[CURRENT_PHASE].max)
			  end

			  if CURRENT_PHASE > 1 then
			    damage = damage * PLAYERS_HITS
        end

			  return doCreatureAddHealth(target, -damage, CONST_ME_HITAREA, COLOR_GREY)
			end

      		return 0
		end

		setCombatCallback(combats_frames[k], CALLBACK_PARAM_TARGETCREATURE, "onTargetCreature")

		combat_areas[k] = createCombatArea(v)
		setCombatArea(combats_frames[k], combat_areas[k])		
	end

	function onCastSpell(cid, var)

		local lifePercent = math.floor((getCreatureHealth(cid) * 100) / getCreatureMaxHealth(cid))

		if lifePercent <= PHASE[3].begin then
			CURRENT_PHASE = 3
		elseif lifePercent <= PHASE[2].begin then
			CURRENT_PHASE = 2
		else
			CURRENT_PHASE = 1
		end

		local list = getSpectators({x = 1995, y = 1820, z = 15}, 18, 18, false)

		for k,v in ipairs(list) do
			if isPlayer(v) then
				doPlayerSendTextMessage(v, MESSAGE_STATUS_CONSOLE_BLUE, "Behemoth King usou a habilidade DEATH WAVE. Se esconda para evitar dano em vocÃª e nos outros!")
			end
		end

		doCreatureSay(cid, "KING DEATH WAVE IS COMING!", TALKTYPE_MONSTER_YELL)
		addEvent(doCombatFrame, 1000 * 4, cid, var, 1)	

		return true
	end

	function doCombatFrame(cid, var, frame)
		if combats_frames[frame] ~= nil then
			doCombat(cid, combats_frames[frame], var)

			addEvent(doCombatFrame, PHASE[CURRENT_PHASE].interval, cid, var, frame + 1)
		else
			
			PLAYERS_HITS = 0
		end
	end
